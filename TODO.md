# TODO: Electricity Shutdowns MCP Server

## Фаза 1: Исследование и подготовка
- [ ] Исследовать сайт ДТЭК (https://www.dtek-dnem.com.ua/ua/shutdowns)
  - [ ] Изучить структуру формы
  - [ ] Понять как формируется запрос
  - [ ] Исследовать структуру таблицы с графиком
  - [ ] Проверить возможность использования API (если есть)
- [ ] Определить зависимости и библиотеки
- [ ] Создать структуру проекта

## Фаза 2: Настройка окружения
- [ ] Создать pyproject.toml / requirements.txt
- [ ] Настроить виртуальное окружение Python
- [ ] Установить MCP SDK (`mcp`)
- [ ] Установить библиотеки для парсинга (requests, beautifulsoup4/playwright)
- [ ] Создать базовую структуру файлов

## Фаза 3: Парсер сайта ДТЭК
- [ ] Реализовать функцию заполнения формы (населенный пункт, улица, номер дома)
- [ ] Реализовать парсинг таблицы "Графік відключень:" (точный график на сегодня/завтра)
  - [ ] Парсинг даты и дня недели
  - [ ] Парсинг временных интервалов (часы)
  - [ ] Определение типа отключения (✗, ⚡, серый фон)
- [ ] Реализовать парсинг таблицы "Графік можливих відключень на тиждень:" (прогноз)
  - [ ] Парсинг дней недели
  - [ ] Парсинг временных интервалов
  - [ ] Определение типа возможного отключения
- [ ] Структурировать данные (ScheduleType.ACTUAL vs POSSIBLE_WEEK)
- [ ] Добавить обработку ошибок (сайт недоступен, изменилась структура)
- [ ] Тестирование парсера

## Фаза 4: Основной MCP-сервер
- [ ] Инициализировать MCP-сервер
- [ ] Реализовать tool: `check_outage_schedule` (проверка точного графика + опционально прогноз)
- [ ] Реализовать tool: `get_next_outage` (следующее отключение из точного графика)
- [ ] Реализовать tool: `get_outages_for_day` (отключения для конкретного дня)
- [ ] Реализовать tool: `configure_monitoring` (настройка мониторинга)
- [ ] Реализовать конфигурацию (адрес пользователя, настройки)
- [ ] Добавить хранение данных (кеш обоих типов графиков)

## Фаза 5: Логика мониторинга и уведомлений
- [ ] Реализовать периодическую проверку точного графика (ACTUAL)
- [ ] Детект изменений точного графика (сравнение с предыдущей версией)
- [ ] Логика уведомлений за N минут до отключения (только для точного графика)
- [ ] Форматирование уведомлений с указанием типа отключения

## Фаза 6: Интеграция с Claude Code
- [ ] Создать конфигурационный файл для Claude Code
- [ ] Протестировать запуск через claude-cli
- [ ] Проверить работу всех tools
- [ ] Отладка и фиксы

## Фаза 7: Internationalization (i18n)
- [ ] Добавить поддержку английского языка. У нас будет поддерживаться 2 языка: украинский и английский.
- [ ] Локализация сообщений и уведомлений
- [ ] Тестирование на разных языках
- [ ] Добавить возможность выбора языка в конфигурации / или автоопределение
- [ ] Перевести README и документацию на английский
- [ ] в mcp help выводить все возможные опции запросов на обоих языках

## Фаза 8: Дополнительные фичи
- [ ] Расчет оптимального времени зарядки (tool: `calculate_charging_time`)
- [ ] Настраиваемые интервалы проверки
- [ ] Поддержка нескольких адресов
- [ ] История изменений графика

## Документация
- [ ] README.md с инструкцией по установке
- [ ] Документация по использованию
- [ ] Примеры использования tools
- [ ] Troubleshooting секция

## Тестирование
- [ ] Тесты для парсера
- [ ] Тесты для MCP tools
- [ ] End-to-end тестирование
